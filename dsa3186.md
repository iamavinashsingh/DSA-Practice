# 3186. Maximum Total Damage With Spell Casting
A magician has various spells.

You are given an array power, where each element represents the damage of a spell. Multiple spells can have the same damage value.

It is a known fact that if a magician decides to cast a spell with a damage of power[i], they cannot cast any spell with a damage of power[i] - 2, power[i] - 1, power[i] + 1, or power[i] + 2.

Each spell can be cast only once.

Return the maximum possible total damage that a magician can cast.

 

Example 1:

Input: power = [1,1,3,4]

Output: 6

Explanation:

The maximum possible damage of 6 is produced by casting spells 0, 1, 3 with damage 1, 1, 4.

Example 2:

Input: power = [7,1,6,6]

Output: 13

Explanation:

The maximum possible damage of 13 is produced by casting spells 1, 2, 3 with damage 1, 6, 6.

 

Constraints:

1 <= power.length <= 10^5
1 <= power[i] <= 10^9

---


```cpp
class Solution {
public:
    long long solve(int idx, vector<pair<long long,long long>> &v, vector<long long> &dp)
    {
        if(idx>=v.size()){
            return 0;
        }
        
        if(dp[idx]!=-1) return dp[idx];

        //skip current
        long long skip = solve(idx+1,v,dp);

        //if we consider the current one -> we need to decide what will be the next valid idx
        int j = idx+1;
        while(j<v.size() && v[j].first<=v[idx].first+2) j++;

        long long consider = v[idx].second + solve(j,v,dp);

        return dp[idx]=max(skip,consider);
    }
    long long maximumTotalDamage(vector<int>& power) {
        int n = power.size();
        map<long long,long long> mp;
        for(int i=0;i<n;i++)
        {
            mp[power[i]]+=power[i];
        }
        vector<pair<long long,long long>> v;
        for(auto it:mp){
            v.push_back({it.first,it.second});
        }
        sort(v.begin(),v.end());
        vector<long long> dp(v.size(), -1);
        return solve(0,v,dp);
    }
};

```
